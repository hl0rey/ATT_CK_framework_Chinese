# 水坑攻击

水坑攻击是指攻击者通过用户正常的访问网站的行为来获取目标权限的攻击手法。这种攻击以目标用户的浏览器为攻击或者说是漏洞利用的目标。

有很多把漏洞利用代码发送到目标浏览器的方法，包括以下几种：

* 攻击者拿下一个合法的网站之后，在其网页中注入恶意代码（JavaScript、IFrames、跨站脚本等）。
* 通过合法的广告提供商去散播恶意的广告。
* 任何可以让攻击者显示网页内容，或者在用户机器上执行脚本的的Web程序内置的接口。（论坛发帖、评论或者其他用户可以自定义内容的功能）

通常被攻击者用作水坑的工具的网站是被特定群体访问的，比如政府、特定行业和地区，其中的人是特定的用户、或者因为共同的爱好聚集起来的一群人。这种攻击手法被叫做策略性网络攻击或者水坑攻击。这有几个已知的例子。

## 缓解方法

先不管

## 例子

不管

## 检测

防火墙和代理可以检测URL里的可能的已知的恶意域名和参数。他们可以对网站和他们加载的资源做名誉检测，例如这个域名注册多长时间了，这个域名属于谁，如果域名在已知的黑名单上，那么有多少用户曾经连接过它。

网络入侵检测系统有时会有SSL/TLS中间人检查功能（也就是说能解密https的流量），这能够帮助发现已知的恶意脚本（信息收集、堆喷射、浏览器标识脚本经常被重用）、基本的脚本混淆和漏洞利用代码。

检测基于合法网站的水坑攻击可能比较困难。查看用户终端可能会发现成功的水坑攻击，比如浏览器进程的不正常行为。不正常的行为包括可疑的文件写入磁盘、注入进程隐藏执行代码、扫描发现其他机器、或者其他表明攻击者向目标传输了其他工具的行为。

